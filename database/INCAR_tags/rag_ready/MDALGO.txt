MDALGO = 0 | 1 | 2 | 3 | 4 | 5 | 11 | 21 | 13 Default: MDALGO = 0 Description: MDALGO specifies the molecular-dynamics-simulation protocol (in case IBRION =0 and VASP was compiled with -Dtbdyn ). MDALGO =0: Standard molecular dynamics Should provide the same results as MDALGO =2 ( Nose-Hoover thermostat ). The difference is that it is a different implementation and works also without the precompiler flag -Dtbdyn . NVE ensemble To perform a calculation in the NVE ensemble: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =0 and set SMASS =-3. MDALGO =1: Andersen thermostat For the description of the Andersen thermostat see: Andersen thermostat . The Andersen thermostat is only available for the NVT ensemble. Standard molecular dynamics in For a standard molecular dynamics run with Anderson thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =1, and choose an appropriate setting for ANDERSEN_PROB Constrained molecular dynamics For a description of constrained molecular dynamics see Constrained molecular dynamics . For a constrained molecular dynamics run with Andersen thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set MDALGO =1, and choose an appropriate setting for ANDERSEN_PROB Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 0 When the free-energy gradient is to be computed, set LBLUEOUT =.TRUE. Slow-growth approach For a description of slow-growth approach see Slow-growth approach . For a slow-growth simulation, one has to perform a calcualtion very similar to Constrained molecular dynamics but additionally the transformation velocity-related INCREM -tag for each geometric parameter with STATUS=0 has to be specified: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set MDALGO =1, and choose an appropriate setting for ANDERSEN_PROB Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 0 When the free-energy gradient is to be computed, set LBLUEOUT =.TRUE. Specify the transformation velocity-related INCREM -tag for each geometric parameter with STATUS=0 . Monitoring geometric parameters Geometric parameters with STATUS = 7 in the ICONST -file are monitored during the MD simulation. The corresponding values are written onto the REPORT -file, for each MD step, after the lines following the string Monit_coord . Sometimes it is desirable to terminate the simulation if all values of monitored parameters get larger that some predefined upper and/or lower limits. These limits can be set by the user by means of the VALUE_MAX and VALUE_MIN -tags. To monitor geometric parameters during an MD run: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =1, and choose an appropriate setting for ANDERSEN_PROB . Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 7. Optionally, set the upper and/or lower limits for the coordinates, by means of the VALUE_MAX and VALUE_MIN -tags, respectively. Metadynamics For a description of metadynamics see Metadynamics . For a metadynamics run with Andersen thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =1 (or MDALGO =11 in VASP 5.x), and choose an appropriate setting for ANDERSEN_PROB . Set the parameters HILLS_H , HILLS_W , and HILLS_BIN . Define collective variables in the ICONST -file, and set the STATUS parameter for the collective variables to 5. If needed, define the bias potential in the PENALTYPOT -file. The actual time-dependent bias potential is written to the HILLSPOT -file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the PENALTYPOT -file. For the continuation of a metadynamics run, copy HILLSPOT to PENALTYPOT . The values of all collective variables for each MD step are listed in REPORT -file, check the lines after the string Metadynamics . Biased molecular dynamics For a description of biased molecular dynamics see Biased molecular dynamics . For a biased molecular dynamics run with Andersen thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =1 (or MDALGO =11 in VASP 5.x), and choose an appropriate setting for ANDERSEN_PROB . In order to avoid updating of the bias potential, set HILLS_BIN = NSW . Define collective variables in the ICONST -file, and set the STATUS parameter for the collective variables to 5. Define the bias potential in the PENALTYPOT -file if necessary. The values of all collective variables for each MD step are listed in the REPORT -file, check the lines after the string Metadynamics . Special case: NVE ensemble NVE ensemble calculations can be also run by selecting the Anderson thermostat and setting the update collision probability ( ANDERSEN_PROB ) to zero. To run an NVE ensemble: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =1 and ANDERSEN_PROB =0.0. MDALGO =2: Nose-Hoover thermostat For the description of the Nose-Hoover thermostat see: Nose-Hoover thermostat . The Nose-Hoover thermostat is currently only available for the NVT ensemble. Standard molecular dynamics For a standard molecular dynamics run with Nose-Hoover thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =2, and choose an appropriate setting for SMASS . Constrained molecular dynamics For a description of constrained molecular dynamics see Constrained molecular dynamics . For a constrained molecular dynamics run with Nose-Hoover thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =2, and choose an appropriate setting for SMASS . Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 0. When the free-energy gradient is to be computed, set LBLUEOUT =.TRUE. Slow-growth approach For a description of slow-growth approach see Slow-growth approach . For a slow-growth approach run with Nose-Hoover thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set MDALGO =2, and choose an appropriate setting for SMASS Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 0 When the free-energy gradient is to be computed, set LBLUEOUT =.TRUE. Specify the transformation velocity-related INCREM -tag for each geometric parameter with STATUS=0 Monitoring geometric parameters Geometric parameters with STATUS = 7 in the ICONST -file are monitored during the MD simulation. The corresponding values are written onto the REPORT -file, for each MD step, after the lines following the string Monit_coord . Sometimes it is desirable to terminate the simulation if all values of monitored parameters get larger that some predefined upper and/or lower limits. These limits can be set by the user by means of the VALUE_MAX and VALUE_MIN -tags. To monitor geometric parameters during an MD run: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set MDALGO =2, and choose an appropriate setting for SMASS Define geometric constraints in the ICONST -file, and set the STATUS parameter for the constrained coordinates to 7 Optionally, set the upper and/or lower limits for the coordinates, by means of the VALUE_MAX and VALUE_MIN -tags, respectively. Metadynamics For a description of metadynamics see Metadynamics . For a metadynamics run with Nose-Hoover thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =2 (or MDALGO =21 in VASP 5.x), and choose an appropriate setting for SMASS . Set the parameters HILLS_H , HILLS_W , and HILLS_BIN . Define collective variables in the ICONST -file, and set the STATUS parameter for the collective variables to 5. If needed, define the bias potential in the PENALTYPOT -file. The actual time-dependent bias potential is written to the HILLSPOT -file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the PENALTYPOT -file. For the continuation of a metadynamics run, copy HILLSPOT to PENALTYPOT . The values of all collective variables for each MD step are listed in REPORT -file, check the lines after the string Metadynamics . Biased molecular dynamics For a description of biased molecular dynamics see Biased molecular dynamics . For a biased molecular dynamics run with Nose-Hoover thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set MDALGO =2 (or MDALGO =21 in VASP 5.x), and choose an appropriate setting for SMASS . In order to avoid updating of the bias potential, set HILLS_BIN = NSW . Define collective variables in the ICONST -file, and set the STATUS parameter for the collective variables to 5. Define the bias potential in the PENALTYPOT -file. The values of all collective variables for each MD step are listed in the REPORT -file, check the lines after the string Metadynamics . MDALGO =3: Langevin thermostat For the description of the Langevin thermostat see: Langevin thermostat . The Langevin thermostat is available for NVT and NpT ensembles. NVT -simulation with Langevin thermostat To run an NVT -simulation with a Langevin thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set ISIF =2. Set MDALGO =3 to invoke the Langevin thermostat. Specify friction coefficients for all species in the POSCAR file, by means of the LANGEVIN_GAMMA -tag. NpT -simulation with Langevin thermostat The Langevin dynamics in the isobaric-isothermal ensemble is calculated by the method of Parrinello and Rahman   (see NpT ensemble for more descriptions) combined with a Langevin thermostat . To run an NpT-simulation (Parinello-Rahman dynamics) with a Langevin thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW . Set ISIF =3 to allow for relaxation of the cell volume and shape. At the moment, dynamics with fixed volume+variable shape ( ISIF =4) or fixed shape+variable volume ( ISIF =7) are not available. Set MDALGO =3 to invoke the Langevin thermostat. Specify friction coefficients for all species in the POSCAR file, by means of the LANGEVIN_GAMMA -tag. Specify a separate set of friction coefficient for the lattice degrees-of-freedom, using the LANGEVIN_GAMMA_L -tag. Set a mass for the lattice degrees-of-freedom, using the PMASS -tag. Optionally, one may define an external pressure (in kB), by means of the PSTRESS -tag. Note that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the MDALGO =3 setting. Stochastic boundary conditions In some cases it is desirable to study approach of initially non-equilibrium system to equilibrium. Examples of such simulations include the impact problems when a particle with large kinetic energy hits a surface or calculation of friction force between two surfaces sliding with respect to each other. As shown by Toton et al.  , this type of problems can be studied using the stochastic boundary conditions (SBC) derived from the generalized Langevin equation by Kantorovich and Rompotis.  In this approach, the system of interest is divided into three regions: (a) fixed atoms, (b) the internal (Newtonian) atoms moving according to Newtonian dynamics, and (c) a buffer region of Langevin atoms ( i.e. , atoms governed by Langevin equations of motion ) located between (a) and (b). The role of the Langevin atoms is to dissipate heat, while the fixed atoms are needed solely to create the correct potential well for the Langevin atoms to move in. The Newtonian region should include all atoms relevant to the process under study: in the case of the impact problem, for instance, the Newtonian region should contain atoms of the molecule hitting the surface and several uppermost layers of the material forming the surface. Performing molecular dynamics with such a setup guarantees that the system (possibly out of equilibrium initially) arrives at the appropriate canonical distribution. To run a simulation with stochastic boundary conditions, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set ISIF =2 Set MDALGO =3 to invoke the Langevin thermostat Prepare the POSCAR file in such a way that the Newtonian and Langevin atoms are treated as different species (even if they are chemically identical). In your POSCAR , use "selective dynamics" and the corresponding logical flags to define the frozen and moveable atoms. Specify friction coefficients gamma, for all species in the POSCAR file, by means of the LANGEVIN_GAMMA -tag: set the friction coefficients to 0 for all fixed and Newtonian atoms, and choose a proper gamma for the Langevin atoms. Consider a system consisting of 16 hydrogen and 48 silicon atoms. Suppose that eight silicon atoms are considered to be Langevin atoms and the remaining 32 Si atoms are either fixed or Newtonian atoms. The Langevin and Newtonian (or fixed) atoms should be considered as different species, i.e. , the POSCAR -file should contain the line like this: As only the final eight Si atoms are considered to be Langevin atoms, the INCAR -file should contain the following line defining the friction coefficients: i.e. , for all non-Langevin atoms, gamma should be set to zero. MDALGO =4: Nose Hoover chains thermostat For a description of Nose Hoover chains theromastat, see NHC thermostat . To run an NVT -simulation with a Nose Hoover chains thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set ISIF =2 Set MDALGO =4 to invoke the thermostat, select the number of thermostats in chain via NHC_NCHAINS and choose an appropriate setting for the thermostat parameter NHC_PERIOD . Note that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the MDALGO =4 setting. MDALGO =5: Canonical sampling through velocity-rescaling (CSVR thermostat) For a description of CSVR theromastat, see CSVR thermostat . To run an NVT -simulation with a CSVR thermostat, one has to: Set the standard MD-related tags: IBRION =0, TEBEG , POTIM , and NSW Set ISIF =2 Set MDALGO =5 to invoke the thermostat and choose an appropriate setting for the thermostat parameter CSVR_PERIOD . Note that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the MDALGO =5 setting. MDALGO =13: Multiple Andersen thermostats Up to three user-defined atomic subsystems may be coupled with independent Andersen thermostats  (see remarks under MDALGO =1 as well). The POSCAR file must be organized such that the positions of atoms of subsystem i+1 are defined after those for the subsystem i , and the following flags must be set by the user: NSUBSYS = TSUBSYS = PSUBSYS = Related Tags and Sections IBRION , ISIF , SMASS , ANDERSEN_PROB , RANDOM_SEED , LBLUEOUT , SHAKETOL , SHAKEMAXITER , HILLS_H , HILLS_W , HILLS_BIN , INCREM , VALUE_MIN , VALUE_MAX , LANGEVIN_GAMMA , LANGEVIN_GAMMA_L , PMASS , NSUBSYS , TSUBSYS , PSUBSYS , ICONST , PENALTYPOT , HILLSPOT , REPORT Examples that use this tag References