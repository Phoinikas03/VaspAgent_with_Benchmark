LCHIMAG = .TRUE. | .FALSE. Default: LCHIMAG = .FALSE. Description: calculate the chemical shifts by means of linear response. For LCHIMAG =.TRUE., VASP calculates the chemical shift tensors. The chemical shielding tensor is defined as: Here {\displaystyle \mathbf{R}} {\displaystyle \mathbf{R}} denotes the atomic nuclear site, {\displaystyle i} {\displaystyle i} and {\displaystyle j} {\displaystyle j} denote cartesian indices, {\displaystyle B^{\mathrm{ext}}} {\displaystyle B^{\mathrm{ext}}} an applied DC external magnetic field and {\displaystyle B^{\mathrm{in}}(\mathbf{R})} {\displaystyle B^{\mathrm{in}}(\mathbf{R})} the induced magnetic field at the nucleus. NMR experiments yield information on the symmetric part of the tensor. Typical NMR experiments yield information on the shielding relative to that of a reference compound: In this (approximate) formula {\displaystyle \sigma_{ij}^{\mathrm{ref}}} {\displaystyle \sigma_{ij}^{\mathrm{ref}}} is the isotropic shielding of the nucleus in the reference compound. {\displaystyle \delta_{ij}(\mathbf{R})} {\displaystyle \delta_{ij}(\mathbf{R})} is the chemical shift tensor. In VASP the chemical "shift" tensor is calculated as: This is minus the shielding tensor. It is not the true chemical shift tensor. To convert it to the real shift tensor one should add the reference shielding: VASP calculates chemical "shifts" for non-metallic crystalline systems using the linear response method of Yates, Pickard, and Mauri   Input A typical INCAR could look like this: General tags The first block of tags in the INCAR above expresses the fact that the calculations of chemical shifts by means of linear response often require a high accuracy: PREC = Accurate EDIFF = 1E-8 Large ENCUT ). The chemical shifts are calculated from the orbital magnetic response under the assumption that the system is an insulator. Smearing schemes intended for metals can generate nonsense. Use ISMEAR =0 and make SIGMA so small that states have no fractional occupancies. NMR specific tags The second block of tags switches on the calculation of the chemical shifts ( LCHIMAG =.TRUE.), and controls several aspects of the finite difference k -space derivatives (Eqs. 38, 40, and 47 in the work of Yates et al.  ): DQ is the step size for the finite difference k-space derivative. Typical values are in the range . The default ( DQ =0.001) is often sufficient. ICHIBARE determines the order of the finite difference stencil used to calculate the magnetic susceptibility (second order derivative in Eq. 47 of Yates et al.  ). Note that magnetic susceptibility is a bulk property, while chemical shift is for each nucleus  . A higher ICHIBARE results in a substantial increase of the computational load. For NLSPLINE =.TRUE., the PAW projectors in reciprocal space ( LREAL =.FALSE.) are set up using a spline interpolation so that they are k -differentiable. This improves the susceptibility contribution to the shifts (via the aforementioned Eq. 47). Other contributions to the shifts (Eqs. 38 and 40) are only slightly affected. LNMR_SYM_RED =.TRUE. is recommended. The star on which the k -space derivative is calculated is oriented along the cartesian directions in k -space. If the symmetry operations in k -space do not map this star onto itself, erroneous results can be obtained. LNMR_SYM_RED =.TRUE. checks for such operations, discarding them, resulting in a larger IBZ. There are also some additional tags relevant to LCHIMAG that are not used in the example INCAR that should be considered in special cases: LBONE adds the small B-component to the chemical shift tensor  . LVGVCALC uses the vGv expression when calculating the orbital magnetic susceptibility   . LVGVAPPL uses vGv orbital magnetic susceptibility when calculating the chemical shift anisotropy (CSA) tensor. LLRAUG calculates the two-center contributions to the chemical shielding tensor . The chemical shift is calculated via the induced current (cf. LWRTCUR )   . It has contributions from the plane wave grid and one-center contributions (the induced field at the center of a PAW sphere due to the augmentation current inside that sphere). Two-center contributions (induced fields due to augmentation currents in other PAW spheres) are standard neglected. These contributions can be switched on using LLRAUG . Output The isotropic chemical shieldings are printed towards the end of the OUTCAR file, after the self-consistent calculation has finished. The chemical shift tensors both before and after space group symmetrization. These are the absolute tensors for the infinite lattice, excluding core contributions. They can be searched for under the UNSYMMETRIZED TENSORS and SYMMETRIZED TENSORS after Absolute Chemical Shift tensors . Additionally, the magnetic susceptibility is printed shortly after and found under ORBITAL MAGNETIC SUSCEPTIBILITY . To obtain the full absolute tensors requires adding both the {\displaystyle \mathbf{G=0}} {\displaystyle \mathbf{G=0}} contribution and the contributions due to the core electrons. The latter consist of contributions for each chemical species separately (depending on POTCAR ) and a global {\displaystyle \mathbf{G=0}} {\displaystyle \mathbf{G=0}} susceptibility contribution. The reference shift experienced by the core is given first: Finally the tensor is processed and its (CSA) characteristics are printed in the OUTCAR . The tensor is symmetrized ( {\displaystyle \sigma_{ij} = \sigma_{ji}} {\displaystyle \sigma_{ij} = \sigma_{ji}} is enforced) and diagonalized. From the three diagonal values the isotropic chemical "shift" {\displaystyle \delta_{\mathrm{iso}}\mathrm{}} {\displaystyle \delta_{\mathrm{iso}}\mathrm{}} , span {\displaystyle \Omega} {\displaystyle \Omega} and skew {\displaystyle \kappa} {\displaystyle \kappa} are calculated and printed see Ref.  for unambiguous definitions. Note that {\displaystyle \kappa} {\displaystyle \kappa} is ill-defined if {\displaystyle \Omega = 0} {\displaystyle \Omega = 0} . Units are ppm, except for the skew. A typical output is given below: The isotropic chemical shielding for each atom, excluding and including G=0 contributions, as well as the span and skew (descriptions of asymmetry), follow. Finally, core contributions are taken into account for the ISO_SHIFT , SPAN , and SKEW . By default the orbital magnetic susceptibility is calculated using the so-called pGv -approximation, i.e. Eqs. 46-48 of Yates et al.  . As of vasp.6.4.0 also the vGv -approximation of the susceptibility is calculated. By default, the pGv result is applied for the {\displaystyle \mathbf{G=0}} {\displaystyle \mathbf{G=0}} contribution to the shifts. With LVGVAPPL one can force VASP to use the vGv result for the {\displaystyle \mathbf{G=0}} {\displaystyle \mathbf{G=0}} contribution instead. With LVGVCALC one can suppress calculation of the vGv susceptibility. For details see LVGVCALC . Advice and recommendations Input parameters A larger ENCUT value than usual, generally much higher than the value given by ENMAX in the POTCAR file, e.g. 800 eV for C. A small EDIFF is typically required to provide converged chemical shifts, e.g. 1E-8 eV. Tighter precision, e.g. PREC = Accurate. Two additional terms may make a difference depending on your system, which should be tested with and without to determine their importance: Non-spherical contributions to the gradient of the density inside PAW spheres, i.e. LASPH = .TRUE. Occasionally, e.g. for systems containing H or first-row elements, and short bonds, the two-center contributions are important. In this case, LLRAUG = .TRUE. should be used   . PAW pseudopotentials No special POTCAR files are necessary. The GIPAW is applied using the projectors functions and partial waves that are stored in the regular POTCAR files. A few remarks, however, on accuracy in relation to the different POTCAR flavours: Results sensitively depend on the quality, i.e. , completeness of the partial wave/projector function set in the energy range needed for good chemical transferability. Result obtained with different POTCAR flavours can differ a few ppm for first and second row sp -bonded elements (except for H). Use POTCAR files generated with a consistent exchange-correlation functional. The PAW reconstruction with AE partial waves is crucial as the field on the nucleus needs to be calculated. So avoid, if possible, overriding LEXCH from POTCAR with an explicit GGA -tag in the INCAR . Insufficient memory In the case of insufficient memory, there are a few options. Speed has been favored over saving memory. Since the linear response calculation is parallel over k -points, this can be used to economize on memory: First, do a regular self-consistent calculation at high accuracy for the full k -point mesh. Save the CHGCAR file. Second, do a chemical shift calculation for each k -point in the IBZ separately, starting from CHGCAR , i.e. , using ICHARG =11. Finally, calculate the shifts as a k -point weighted average of the symmetrized shifts of the individual k -points. Related tags and articles DQ , ICHIBARE , LNMR_SYM_RED , NLSPLINE , LLRAUG , LBONE , LVGVCALC , LVGVAPPL Examples that use this tag References