ML_LCOUPLE =  Default: ML_LCOUPLE = .FALSE. Description: This tag specifies whether thermodynamic integration is activated in order to calculate the chemical potentials within the machine learning force field method. In thermodynamic integration a coupling parameter {\displaystyle \lambda} {\displaystyle \lambda} is introduced to the Hamiltonian to smoothly switch between a "non-interacting" reference state and a "fully-interacting" state. The change of the free energy along this path is written as {\displaystyle \Delta \mu = \int\limits_{0}^{1} \langle \frac{dH(\lambda)}{d\lambda} \rangle_{\lambda} d\lambda. } {\displaystyle \Delta \mu = \int\limits_{0}^{1} \langle \frac{dH(\lambda)}{d\lambda} \rangle_{\lambda} d\lambda. } Using machine learning force fields the Hamiltonian can be written as {\displaystyle H (\lambda) = \sum\limits_{i=1}^{N_{a}} \frac{|\mathbf{p}_{i}|^2}{2m_{i}} + \sum\limits_{i \notin M} U_{i}(\lambda) + \lambda \sum\limits_{i \in M} U_{i}(\lambda) + \sum\limits_{i}^{N_{a}} U_{i,\mathbf{atom}}. } {\displaystyle H (\lambda) = \sum\limits_{i=1}^{N_{a}} \frac{|\mathbf{p}_{i}|^2}{2m_{i}} + \sum\limits_{i \notin M} U_{i}(\lambda) + \lambda \sum\limits_{i \in M} U_{i}(\lambda) + \sum\limits_{i}^{N_{a}} U_{i,\mathbf{atom}}. } where {\displaystyle N_{a}} {\displaystyle N_{a}} denotes the number of atoms and {\displaystyle U_{i,\mathbf{atom}}} {\displaystyle U_{i,\mathbf{atom}}} is an atomic reference energy for a single non interacting atom. The first term in the equation describes the potential energy and the second and third term describe the potential energy of an atom {\displaystyle i} {\displaystyle i} . The index {\displaystyle M} {\displaystyle M} denotes the atoms whose interaction is controlled by a coupling parameter. The interactions of the atoms are controlled by scaling the contributions to the atom density via the coupling parameter {\displaystyle \rho (\mathbf{r},\lambda) = \sum\limits_{j\notin M} f_{\mathrm{cut}} \left( \left| \mathbf{r}_{j} - \mathbf{r}_{i} \right| \right) g \left + \lambda \sum\limits_{j\in M} f_{\mathrm{cut}} \left( \left| \mathbf{r}_{j} - \mathbf{r}_{i} \right| \right) g \left. } {\displaystyle \rho (\mathbf{r},\lambda) = \sum\limits_{j\notin M} f_{\mathrm{cut}} \left( \left| \mathbf{r}_{j} - \mathbf{r}_{i} \right| \right) g \left + \lambda \sum\limits_{j\in M} f_{\mathrm{cut}} \left( \left| \mathbf{r}_{j} - \mathbf{r}_{i} \right| \right) g \left. } Further details on the implementation can be found in reference  . For thermodynamic integration the following parameters have to be set: ML_MODE = run . ML_LCOUPLE = .TRUE. . The number of atoms for which a coupling parameter is introduced ( {\displaystyle i \in M } {\displaystyle i \in M } ): ML_NATOM_COUPLED . The list of atom indices that for that the coupling parameter is applied in the interaction: ML_ICOUPLE . The strength of the coupling parameter {\displaystyle \lambda} {\displaystyle \lambda} between 0 and 1: ML_RCOUPLE . The derivative of the hamiltonian with respect to the coupling constant {\displaystyle dH/d\lambda} {\displaystyle dH/d\lambda} is written out at every MD step to the ML_LOGFILE . A sample output should look like this: References Related tags and articles ML_LMLFF , ML_NATOM_COUPLED , ML_ICOUPLE , ML_RCOUPLE Examples that use this tag