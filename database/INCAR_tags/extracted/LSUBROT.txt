<p><a class="mw-selflink selflink">LSUBROT</a> = .FALSE. | .TRUE. 
</p>
<p>Description: This flag can be set for <a href="/wiki/index.php/Category:Hybrid_functionals" title="Category:Hybrid functionals">hybrid functionals</a> (HF-type calculations). <a class="mw-selflink selflink">LSUBROT</a> determines whether an optimal rotation matrix between the occupied and unoccupied block is sought, when a direct optimization of the energy functional is performed (i.e. <a href="/wiki/index.php/ALGO" title="ALGO">ALGO</a>=All | Damped). The corresponding algorithm is unpublished.  <a class="mw-selflink selflink">LSUBROT</a> =.FALSE. is the standard algorithm, in which the rotation matrix between occupied and unoccupied orbitals is determined essentially using Loewdin perturbation theory, as for instance explained in Ref. <sup class="reference" id="cite_ref-kresse:prb:96_1-0"><a href="#cite_note-kresse:prb:96-1">[1]</a></sup>. For <a class="mw-selflink selflink">LSUBROT</a> =.TRUE. the rotation matrix is instead optimized by performing a few standard SCF steps, in which the orbitals are kept fixed, but rotations between the occupied and unoccupied manifold are allowed. Once satisfactory convergence has been reached, the optimized density matrix (rotation matrix between occupied and unoccupied block) is passed back to the direct optimization routine and a rotation along the suggested direction is performed alongside an update of the orbitals. This generally speeds up calculations for small gap systems as well as metals. However, in rare cases, we have observed instabilities, so be careful when selecting <a class="mw-selflink selflink">LSUBROT</a> =.TRUE. 
</p>
<p>Although the flag can be set for standard functionals, it is only efficient for hybrid functionals (HF-type calculations).
</p>
<h2><span class="mw-headline" id="References">References</span></h2>
