<p><a class="mw-selflink selflink">ML_MODE</a> = train | select | refit | refitbayesian | run | none<br/> Default: <b>ML_MODE</b> =  none 
</p>
<p>Description: String-based tag selecting operation mode for machine learning force fields.
</p>
<p>This tag acts as a "super tag" and selects the operation mode by selecting the defaults for all other tags. Every tag that is affected by this "super tag" can be overwritten by the user by simply specifying the value for that tag.
The following options are available for this tag:
</p>
<ul>
<li><code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = train</code><b>: On-the-fly training</b><p>
Force predictions from the machine learning force field are used to drive the molecular dynamics (MD) simulation. However, if the error estimation performed in each time step indicates a high force error an ab initio calculation is performed instead and the collected energy, forces, and stress are used to improve the machine learning force field. There are two possible cases depending on, whether an <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> is present in the calculation folder or not:</p>
<ol>
<li>
No <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file found:<p>
On-the-fly training is starting from scratch. Note that at the beginning of the MD run, when there is no force field available or it is still poorly trained, <i>ab initio</i> calculations will happen frequently. For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 0</code>.</p>
</li>
<li>
<a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file present:<p>
Restart on-the-fly training from existing training database. Before the MD run starts the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file (a copy of the <a href="/wiki/index.php/ML_ABN" title="ML ABN">ML_ABN</a> from a previous training run!) is read and the <i>ab initio</i> data (energies, forces, and stresses) and local reference configurations it contains are used to generate an initial force field. Subsequently, the on-the-fly training MD is started. For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 1</code>.</p>
<table style="border: 0px solid #3E70EA; padding: 5px; background: #BBCCF5">
<tbody><tr>
<td><b><span style="color: #3E70EA;">Tip:</span></b> None of the structures in the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file need to match he <a href="/wiki/index.php/POSCAR" title="POSCAR">POSCAR</a> file for the current MD training run in terms of the simulation box, elements, or number of atoms. However, if the same elements appear the initial force field is used for predictions in the current MD run.
<p>The training data contained in the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file is included in the final machine learning force field, i.e., the <a href="/wiki/index.php/ML_FFN" title="ML FFN">ML_FFN</a> file will define a force field applicable to both the structures on the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file as well as to the current MD simulation. This means that by restarting repeatedly with <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = train</code>, and copying the <a href="/wiki/index.php/ML_ABN" title="ML ABN">ML_ABN</a> file from the previous run to <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a>(!), it is possible to iteratively extend the applicability of the a machine learning force field, e.g., by exploring different temperature ranges or element compositions.
</p>
</td></tr></tbody></table>
</li>
</ol>
</li><br/>
<li>
<code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = select</code><b>: Re-selection of local reference configurations</b><p>
A new machine learning force field is generated from the <i>ab initio</i> data provided in the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file. The structures are read and processed one by one as if harvested in an MD simulation. In other words, the same steps are performed as in on-the-fly training but the source of the data are not actual <i>ab initio</i> calculations in an MD run but the series of structures available in the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file. The list of local reference configurations on the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file will be ignored. Instead a new collection of local reference configurations is determined and written to the resulting <a href="/wiki/index.php/ML_ABN" title="ML ABN">ML_ABN</a> file.</p>
<table style="border: 0px solid #8342A4; padding: 5px; background: #DEC4EB">
<tbody><tr>
<td><b><span style="color: #8342A4;">Important:</span></b> This operation mode allows to generate a VASP machine learning force field from pre-computed or external <i>ab initio</i> data sets. In contrast to <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refit</code> also the local reference configurations are selected from the entire data set. For example, an <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file created manually by extracting <i>ab initio</i> data (energies, forces, stresses) from <a href="/wiki/index.php/OUTCAR" title="OUTCAR">OUTCAR</a> files (or even other external sources) can be processed in this mode without prior knowledge of local reference configurations (only a dummy section must be added to the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file, see its documentation). Similar to on-the-fly training this mode generates <a href="/wiki/index.php/ML_FFN" title="ML FFN">ML_FFN</a> files and <a href="/wiki/index.php/ML_ABN" title="ML ABN">ML_ABN</a> <b>with</b> local reference configurations.
</td></tr></tbody></table><p>
A new iteration through the training structures can lead to a frequent update of the force field. This is quite time-consuming. Hence, for this mode the default value of <a href="/wiki/index.php/ML_CDOUB" title="ML CDOUB">ML_CDOUB</a> is automatically increased from 2 to 4 which will result in a much less frequent update of the force field. This leads to much more efficient calculations while practically not changing the results.</p>
<table style="border: 0px solid #3E70EA; padding: 5px; background: #BBCCF5">
<tbody><tr>
<td><b><span style="color: #3E70EA;">Tip:</span></b> If calculations for <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = select</code> are too time-consuming, it is useful to increase <a href="/wiki/index.php/ML_MCONF_NEW" title="ML MCONF NEW">ML_MCONF_NEW</a> to values around 10-16. Together with <code style="padding: 2px"><a href="/wiki/index.php/ML_CDOUB" title="ML CDOUB">ML_CDOUB</a> = 4</code>, this often accelerates the calculations by a factor of 2-4.
</td></tr></tbody></table><p>
The <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file may contain values for <tt>CTIFOR</tt> for each training structure. These are the thresholds used to sample that structure from the previous training. The thresholds found on the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> will be re-used unless a threshold is explicitly specified in the <a href="/wiki/index.php/INCAR" title="INCAR">INCAR</a> file, by means of the <a href="/wiki/index.php/ML_CTIFOR" title="ML CTIFOR">ML_CTIFOR</a> tag. In the latter case the thresholds from the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file are ignored. In case the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> contains <b>no</b> <tt>CTIFOR</tt> information and <b>no</b> threshold is specified in the <a href="/wiki/index.php/INCAR" title="INCAR">INCAR</a> file, the default value for <a href="/wiki/index.php/ML_CTIFOR" title="ML CTIFOR">ML_CTIFOR</a> is used.</p><p class="mw-empty-elt">
</p><p>This mode automatically sets <code style="padding: 2px"><a href="/wiki/index.php/NSW" title="NSW">NSW</a> = 1</code> and <code style="padding: 2px"><a href="/wiki/index.php/ML_CDOUB" title="ML CDOUB">ML_CDOUB</a> = 4</code>.For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 3</code>.
</p>
<table style="border: 0px solid #A82C35; padding: 5px; background: #F1B3BA">
<tbody><tr>
<td><b><span style="color: #A82C35;">Warning:</span></b> <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = select</code> ignores the structure in the <a href="/wiki/index.php/POSCAR" title="POSCAR">POSCAR</a> and hence no error, force and stress predictions are made at the end of this calculation (instead zeros are written to stdout, <a href="/wiki/index.php/OSZICAR" title="OSZICAR">OSZICAR</a> and <a href="/wiki/index.php/OUTCAR" title="OUTCAR">OUTCAR</a>).
</td></tr></tbody></table><p class="mw-empty-elt"></p>
</li><br/>
<li><code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refit</code><b>: Refit a force field for "fast" evaluation</b><p>
Similar to <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = select</code>, refitting is done based on an existing <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file, but the number of local reference configurations for each species is taken from the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file. Sparsification is performed on the local reference configurations, so the resulting <a href="/wiki/index.php/ML_ABN" title="ML ABN">ML_ABN</a> file will contain the same number or fewer local reference configurations than the <a href="/wiki/index.php/ML_AB" title="ML AB">ML_AB</a> file.</p><p>
By default the resulting force field is geared towards "fast" evaluation to speed up production runs (<code style="padding: 2px"><a href="/wiki/index.php/ML_LFAST" title="ML LFAST">ML_LFAST</a> = .TRUE.</code>). This comes at the cost of not being able to evaluate Bayesian error estimates.</p>
<table style="border: 0px solid #A82C35; padding: 5px; background: #F1B3BA">
<tbody><tr>
<td><b><span style="color: #A82C35;">Warning:</span></b> We strongly advise to use <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refit</code> if no Bayesian error estimates are required during production runs.
</td></tr></tbody></table><p>
This mode automatically sets <code style="padding: 2px"><a href="/wiki/index.php/ML_LFAST" title="ML LFAST">ML_LFAST</a> = .TRUE.</code>, <code style="padding: 2px"><a href="/wiki/index.php/NSW" title="NSW">NSW</a> = 1</code>, <code style="padding: 2px"><a href="/wiki/index.php/ML_IALGO_LINREG" title="ML IALGO LINREG">ML_IALGO_LINREG</a> = 4</code>, <code style="padding: 2px"><a href="/wiki/index.php/ML_SIGW0" title="ML SIGW0">ML_SIGW0</a> = 1E-7</code>, <code style="padding: 2px"><a href="/wiki/index.php/ML_SIGV0" title="ML SIGV0">ML_SIGV0</a> = 1</code> and <code style="padding: 2px"><a href="/wiki/index.php/ML_EPS_LOW" title="ML EPS LOW">ML_EPS_LOW</a> = 1E-11</code>. For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 4</code>.</p>
</li><br/>
<li><code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refitbayesian</code><b>: Refit a force field with Bayesian regression (deprecated)</b><p>
Same as <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refit</code>, but Bayesian regression is employed. This results in lower accuracy and much slower force fields than using <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refit</code> and should be used with caution. On the other hand, this mode allows the generation of <a href="/wiki/index.php/ML_FFN" title="ML FFN">ML_FFN</a> files that can calculate Bayesian error estimates in addition to predictions.</p><p>
This modes sets <code style="padding: 2px"><a href="/wiki/index.php/NSW" title="NSW">NSW</a> = 1</code>, <code style="padding: 2px"><a href="/wiki/index.php/ML_IALGO_LINREG" title="ML IALGO LINREG">ML_IALGO_LINREG</a> = 1</code> and <code style="padding: 2px"><a href="/wiki/index.php/ML_LFAST" title="ML LFAST">ML_LFAST</a> = .FALSE.</code>. For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 4</code>.</p>
</li><br/>
<li><code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = run</code><b>: Perform only force field predictions</b><p>
A previously trained machine learning force field is read from the <a href="/wiki/index.php/ML_FF" title="ML FF">ML_FF</a> file, and the MD simulation is driven with predictions from the force field only. <b>No</b> <i>ab initio</i> calculations are performed and <b>no</b> learning is executed. This setting is typically used when the machine learning force field is considered mature and ready for production runs.</p><p>
Optionally, if the force field was refitted using <code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = refitbayesian</code>, the Bayesian error estimate of the energies, forces, and stress can be computed and logged in the <a href="/wiki/index.php/ML_LOGFILE" title="ML LOGFILE">ML_LOGFILE</a>. The output frequency of the Bayesian errors can be set via the <a href="/wiki/index.php/ML_IERR" title="ML IERR">ML_IERR</a> tag, the default is 0.</p><p>
For VASP versions prior to 6.4.0 this corresponds to <code style="padding: 2px"><a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a> = 2</code>.</p>
</li><br/>
<li><code style="padding: 2px"><a class="mw-selflink selflink">ML_MODE</a> = none</code><b>: The tag is ignored</b>
</li></ul>
<p><br/>
</p>
<h2><span class="mw-headline" id="Related_tags_and_articles">Related tags and articles</span></h2>
<p><a href="/wiki/index.php/ML_LMLFF" title="ML LMLFF">ML_LMLFF</a>, <a href="/wiki/index.php/ML_ISTART" title="ML ISTART">ML_ISTART</a>, <a href="/wiki/index.php/ML_LFAST" title="ML LFAST">ML_LFAST</a>, <a href="/wiki/index.php/ML_IERR" title="ML IERR">ML_IERR</a>, <a href="/wiki/index.php/ML_OUTBLOCK" title="ML OUTBLOCK">ML_OUTBLOCK</a>, <a href="/wiki/index.php/ML_OUTPUT_MODE" title="ML OUTPUT MODE">ML_OUTPUT_MODE</a>, <a href="/wiki/index.php/ML_IALGO_LINREG" title="ML IALGO LINREG">ML_IALGO_LINREG</a>, <a href="/wiki/index.php/ML_MCONF_NEW" title="ML MCONF NEW">ML_MCONF_NEW</a>, <a href="/wiki/index.php/ML_CDOUB" title="ML CDOUB">ML_CDOUB</a>, <a href="/wiki/index.php/ML_CTIFOR" title="ML CTIFOR">ML_CTIFOR</a>, <a href="/wiki/index.php/ML_IERR" title="ML IERR">ML_IERR</a>
</p>
