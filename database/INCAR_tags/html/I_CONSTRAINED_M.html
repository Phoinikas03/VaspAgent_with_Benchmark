<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-enabled vector-feature-sticky-header-disabled vector-feature-page-tools-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-enabled vector-feature-main-menu-pinned-disabled vector-feature-limited-width-enabled vector-feature-limited-width-content-enabled" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>I_CONSTRAINED_M - VASP Wiki</title>
<script>document.documentElement.className="client-js vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-enabled vector-feature-sticky-header-disabled vector-feature-page-tools-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-enabled vector-feature-main-menu-pinned-disabled vector-feature-limited-width-enabled vector-feature-limited-width-content-enabled";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"c09a5d72bf7e749de254624f","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"I_CONSTRAINED_M","wgTitle":"I CONSTRAINED M","wgCurRevisionId":20734,"wgRevisionId":20734,"wgArticleId":116,"wgIsArticle":
true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["INCAR tag","Magnetism"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"I_CONSTRAINED_M","wgRelevantArticleId":116,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgVector2022PreviewPages":[],"wgEditSubmitButtonLabelPublish":false};RLSTATE={"skins.vector.user.styles":"ready","site.styles":"ready","user.styles":"ready","skins.vector.user":"ready","user":"ready","user.options":"loading","ext.math.styles":"ready","ext.cite.styles":"ready","mediawiki.ui.button":"ready","skins.vector.styles":"ready","skins.vector.icons":"ready","mediawiki.ui.icon":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready"};RLPAGEMODULES=["ext.math.scripts","ext.cite.ux-enhancements","site",
"mediawiki.page.ready","skins.vector.js","skins.vector.es6","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="/wiki/load.php?lang=en&amp;modules=ext.cite.styles%7Cext.math.styles%7Cext.visualEditor.desktopArticleTarget.noscript%7Cmediawiki.ui.button%2Cicon%7Cskins.vector.icons%2Cstyles&amp;only=styles&amp;skin=vector-2022"/>
<script async="" src="/wiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector-2022"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/wiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector-2022"/>
<meta name="generator" content="MediaWiki 1.40.1"/>
<meta name="robots" content="max-image-preview:standard"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0"/>
<link rel="icon" href="/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="VASP Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.vasp.at/wiki/api.php?action=rsd"/>
<link rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt"/>
<link rel="alternate" type="application/atom+xml" title="VASP Wiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-I_CONSTRAINED_M rootpage-I_CONSTRAINED_M skin-vector-2022 action-view skin--responsive"><div class="mw-page-container">
	<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
	<div class="mw-page-container-inner">
		<input
			type="checkbox"
			id="mw-sidebar-checkbox"
			class="mw-checkbox-hack-checkbox"
			>
		<header class="mw-header mw-ui-icon-flush-left mw-ui-icon-flush-right">
			<div class="vector-header-start">
					<label
				id="mw-sidebar-button"
				class="mw-checkbox-hack-button mw-ui-icon mw-ui-button mw-ui-quiet mw-ui-icon-element mw-ui-icon-flush-right"
				for="mw-sidebar-checkbox"
				role="button"
				aria-controls="mw-panel"
				data-event-name="ui.sidebar"
				tabindex="0"
				title="Main menu">
				<span>Toggle sidebar</span>
			</label>
		
<a href="/wiki/index.php/Main_page" class="mw-logo">
	<span class="mw-logo-container">
		<img class="mw-logo-wordmark" alt="VASP Wiki"
			src="/wiki/images/logo-on-white.png" style="width: 11.1875em; height: 2.5em;">
	</span>
</a>

			</div>
			<div class="vector-header-end">
				
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box">
	<a href="/wiki/index.php/Special:Search"
	
		
		
		
		title="Search VASP Wiki [f]"
		accesskey="f"
		class="mw-ui-button mw-ui-quiet mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-search search-toggle">
		<span>Search</span>
	</a>
	
	<div>
		<form action="/wiki/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-moved">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search VASP Wiki" aria-label="Search VASP Wiki" autocapitalize="sentences" title="Search VASP Wiki [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

				<nav class="vector-user-links" aria-label="Personal tools" role="navigation" >
	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet mw-portlet-vector-user-menu-overflow"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login-2" class="user-links-collapsible-item mw-list-item"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=I+CONSTRAINED+M" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</div>

	
<div id="vector-user-links-dropdown" class="vector-menu vector-dropdown vector-menu-dropdown vector-user-menu vector-user-menu-logged-out"  title="More options" >
	<input type="checkbox"
		id="vector-user-links-dropdown-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-vector-user-links-dropdown"
		class="vector-menu-checkbox "
		
		aria-label="Personal tools"
		
	/>
	<label
		id="vector-user-links-dropdown-label"
		for="vector-user-links-dropdown-checkbox"
		class="vector-menu-heading mw-checkbox-hack-button mw-ui-button mw-ui-quiet mw-ui-icon-element "
		aria-hidden="true"
		
	>
		<span class="mw-ui-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal"  title="User menu" >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=I+CONSTRAINED+M" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span class="mw-ui-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li></ul>
		
	</div>
</div>

	
	</div>
</div>
</nav>

			</div>
		</header>
		<div class="vector-main-menu-container ">
			<div id="mw-navigation">
				<nav id="mw-panel" class="vector-main-menu-landmark" aria-label="Site" role="navigation">
						
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	
	
<div id="p-navigation" class="vector-main-menu-group vector-menu mw-portlet mw-portlet-navigation"  >
	<div
		id="p-navigation-label"
		class="vector-menu-heading "
		
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage-description" class="mw-list-item"><a href="/wiki/index.php/Main_page" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-randompage" class="mw-list-item"><a href="/wiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li><li id="n-help-mediawiki" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>Help about MediaWiki</span></a></li></ul>
		
	</div>
</div>

	
	
<div id="p-tb" class="vector-main-menu-group vector-menu mw-portlet mw-portlet-tb"  >
	<div
		id="p-tb-label"
		class="vector-menu-heading "
		
	>
		<span class="vector-menu-heading-label">Tools</span>
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/index.php/Special:WhatLinksHere/I_CONSTRAINED_M" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/index.php/Special:RecentChangesLinked/I_CONSTRAINED_M" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/wiki/index.php?title=I_CONSTRAINED_M&amp;oldid=20734" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/wiki/index.php?title=I_CONSTRAINED_M&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</div>

	

</div>

				</nav>
			</div>
		</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"><div id="localNotice"><div class="sitenotice" lang="en" dir="ltr"><p>Requests for technical support from the VASP team should be posted in the <a rel="nofollow" class="external text" href="https://www.vasp.at/forum/">VASP Forum</a>.
</p></div></div></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
			<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="toc-pinned"
	data-pinnable-element-id="vector-toc"
	
	
>
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text"
			class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Related_tags_and_articles"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Related_tags_and_articles">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Related tags and articles</div>
		</a>
		
		<ul id="toc-Related_tags_and_articles-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-References"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#References">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>References</div>
		</a>
		
		<ul id="toc-References-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

			</div>
		</nav>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main">
				<header class="mw-body-header vector-page-titlebar">
					<label
						id="vector-toc-collapsed-button"
						class="mw-ui-button mw-ui-quiet mw-ui-icon mw-ui-icon-flush-left mw-ui-icon-element mw-ui-icon-wikimedia-listBullet mw-checkbox-hack-button"
						for="vector-toc-collapsed-checkbox"
						role="button"
						aria-controls="toc-toggle-list"
						data-event-name="vector.toc-toggle-list"
						tabindex="0"
						title="Table of Contents">
						Toggle the table of contents
					</label>
				
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-menu vector-dropdown vector-menu-dropdown vector-page-titlebar-toc mw-ui-icon-flush-left"  >
	<input type="checkbox"
		id="vector-page-titlebar-toc-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-vector-page-titlebar-toc"
		class="vector-menu-checkbox "
		
		aria-label="Toggle the table of contents"
		
	/>
	<label
		id="vector-page-titlebar-toc-label"
		for="vector-page-titlebar-toc-checkbox"
		class="vector-menu-heading mw-checkbox-hack-button mw-ui-button mw-ui-quiet mw-ui-icon-element "
		aria-hidden="true"
		
	>
		<span class="mw-ui-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

		<span class="vector-menu-heading-label">Toggle the table of contents</span>
	</label>
	<div class="vector-menu-content vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>
					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">I_CONSTRAINED_M</h1>
				
				
				</header>
				<div class="vector-page-toolbar">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="ca-nstab-main" class="selected vector-tab-noicon mw-list-item"><a data-mw="interface" href="/wiki/index.php/I_CONSTRAINED_M" title="View the content page [c]" accesskey="c" class=""><span>Page</span></a>
</li>
<li id="ca-talk" class="new vector-tab-noicon mw-list-item"><a data-mw="interface" href="/wiki/index.php?title=Talk:I_CONSTRAINED_M&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t" class=""><span>Discussion</span></a>
</li>

		</ul>
		
	</div>
</div>

								

<div id="p-variants" class="vector-menu vector-dropdown vector-menu-dropdown mw-portlet mw-portlet-variants emptyPortlet"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-label="Change language variant"
		
		
	/>
	<label
		id="p-variants-label"
		for="p-variants-checkbox"
		class="vector-menu-heading "
		aria-hidden="true"
		
	>
		
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content vector-dropdown-content">

	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>

	</div>
</div>
							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a data-mw="interface" href="/wiki/index.php/I_CONSTRAINED_M" class=""><span>Read</span></a>
</li>
<li id="ca-viewsource" class="vector-tab-noicon mw-list-item"><a data-mw="interface" href="/wiki/index.php?title=I_CONSTRAINED_M&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e" class=""><span>View source</span></a>
</li>
<li id="ca-history" class="vector-tab-noicon mw-list-item"><a data-mw="interface" href="/wiki/index.php?title=I_CONSTRAINED_M&amp;action=history" title="Past revisions of this page [h]" accesskey="h" class=""><span>View history</span></a>
</li>

		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="More options">
								

<div id="p-cactions" class="vector-menu vector-dropdown vector-menu-dropdown mw-portlet mw-portlet-cactions emptyPortlet vector-has-collapsible-items"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		
		aria-label="More"
		
	/>
	<label
		id="p-cactions-label"
		for="p-cactions-checkbox"
		class="vector-menu-heading"
		aria-hidden="true"
		
	>
		
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content vector-dropdown-content">

	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="/wiki/index.php/I_CONSTRAINED_M"><span>Read</span></a></li><li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/wiki/index.php?title=I_CONSTRAINED_M&amp;action=edit"><span>View source</span></a></li><li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/wiki/index.php?title=I_CONSTRAINED_M&amp;action=history"><span>View history</span></a></li></ul>
		
	</div>

	</div>
</div>
							</nav>
						</div>
					</div>
				</div>
				
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From VASP Wiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><p><a class="mw-selflink selflink">I_CONSTRAINED_M</a>&#160;= 1 | 2 | 4<br /> Default: <b>I_CONSTRAINED_M</b> = none&#160;
</p><p>Description: <a class="mw-selflink selflink">I_CONSTRAINED_M</a> switches on the constrained local moments approach.
</p>
<hr />
<p>VASP offers the possibility to add a penalty contribution to the total energy expression (and consequently a penalty functional to the Hamiltonian) that drives the local magnetic moment (integral of the magnetization in a site centered sphere of radius <a href="/wiki/index.php/RWIGS" title="RWIGS">RWIGS</a>) into a direction given by the <a href="/wiki/index.php/M_CONSTR" title="M CONSTR">M_CONSTR</a>-tag.
</p>
<ul><li><a class="mw-selflink selflink">I_CONSTRAINED_M</a>=1: Constrain the <i>direction</i> of the magnetic moments.</li></ul>
<dl><dd>The total energy is given by</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle E=E_0+ \sum_I\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M}_I\right)\right]^2}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>E</mi>
        <mo>=</mo>
        <msub>
          <mi>E</mi>
          <mn>0</mn>
        </msub>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mi>I</mi>
        </munder>
        <mi>&#x03BB;<!-- λ --></mi>
        <msup>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mover>
                    <mi>M</mi>
                    <mo stretchy="false">&#x2192;<!-- → --></mo>
                  </mover>
                </mrow>
                <mi>I</mi>
              </msub>
              <mo>&#x2212;<!-- − --></mo>
              <msubsup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mover>
                    <mi>M</mi>
                    <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                  </mover>
                </mrow>
                <mi>I</mi>
                <mn>0</mn>
              </msubsup>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msubsup>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mi>M</mi>
                        <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                      </mover>
                    </mrow>
                    <mi>I</mi>
                    <mn>0</mn>
                  </msubsup>
                  <mo>&#x22C5;<!-- ⋅ --></mo>
                  <msub>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mi>M</mi>
                        <mo stretchy="false">&#x2192;<!-- → --></mo>
                      </mover>
                    </mrow>
                    <mi>I</mi>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle E=E_0+ \sum_I\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M}_I\right)\right]^2}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=8cddd939109b3a9c8314864bba5d40a8&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; height: 6.343ex; width: 40.524ex;" alt="{\displaystyle E=E_0+ \sum_I\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M}_I\right)\right]^2}"/></span></dd></dl></dd></dl>
<dl><dd>where <i>E</i><sub>0</sub> is the usual DFT energy, and the second term on the right-hand-side represents the penalty. The sum is taken over all atomic sites <i>I</i>, <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \hat{M}^0_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
          <mn>0</mn>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \hat{M}^0_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=f814d03af5c01c4c623e4ed8424b1cee&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; height: 3.843ex; width: 3.503ex;" alt="{\displaystyle \hat{M}^0_I}"/></span> is the desired direction (unit vector) of the magnetic moment at site <i>I</i> (as specified using <a href="/wiki/index.php/M_CONSTR" title="M CONSTR">M_CONSTR</a>), and <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \vec{M}_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x2192;<!-- → --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \vec{M}_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=15da3de56669a82d324abed01f9f0e0c&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; height: 3.176ex; width: 3.503ex;" alt="{\displaystyle \vec{M}_I}"/></span> is the integrated magnetic moment inside a sphere &#937;<sub><i>I</i></sub> (the radius <b>must</b> be specified by means of <a href="/wiki/index.php/RWIGS" title="RWIGS">RWIGS</a>) around the position of atom <i>I</i>,</dd></dl>
<p><span id="MWint">
</span></p>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \vec{M}_I=\int_{\Omega_I} \vec{m}(\mathbf{r}) F_I(|\mathbf{r}|) d\mathbf{r}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x2192;<!-- → --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
        </msub>
        <mo>=</mo>
        <msub>
          <mo>&#x222B;<!-- ∫ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi mathvariant="normal">&#x03A9;<!-- Ω --></mi>
              <mi>I</mi>
            </msub>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mover>
            <mi>m</mi>
            <mo stretchy="false">&#x2192;<!-- → --></mo>
          </mover>
        </mrow>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <msub>
          <mi>F</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>d</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \vec{M}_I=\int_{\Omega_I} \vec{m}(\mathbf{r}) F_I(|\mathbf{r}|) d\mathbf{r}}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=3b7c89288f0f225a6f943b62e9a82ace&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.671ex; height: 6.009ex; width: 24.567ex;" alt="{\displaystyle \vec{M}_I=\int_{\Omega_I} \vec{m}(\mathbf{r}) F_I(|\mathbf{r}|) d\mathbf{r}}"/></span></dd></dl></dd></dl>
<p class="mw-empty-elt">
</p>
<dl><dd>where <i>F</i><sub><i>I</i></sub>(|<b>r</b>|) is a function of norm 1 inside &#937;<sub><i>I</i></sub>, that smoothly goes to zero towards the boundary of &#937;<sub><i>I</i></sub>.</dd></dl>
<dl><dd>The penalty term in the total energy introduces an additional potential inside the aforementioned spheres centered at the atomic sites <i>I</i>, given by</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle 
V_I (\mathbf{r})=2\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M_I}\right)\right]
\cdot \vec{\sigma} F_I(|\mathbf{r}|) 
}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>V</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mn>2</mn>
        <mi>&#x03BB;<!-- λ --></mi>
        <mrow>
          <mo>[</mo>
          <mrow>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x2192;<!-- → --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
            </msub>
            <mo>&#x2212;<!-- − --></mo>
            <msubsup>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
              <mn>0</mn>
            </msubsup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>M</mi>
                      <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                    </mover>
                  </mrow>
                  <mi>I</mi>
                  <mn>0</mn>
                </msubsup>
                <mo>&#x22C5;<!-- ⋅ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mover>
                    <msub>
                      <mi>M</mi>
                      <mi>I</mi>
                    </msub>
                    <mo stretchy="false">&#x2192;<!-- → --></mo>
                  </mover>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>&#x22C5;<!-- ⋅ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mover>
            <mi>&#x03C3;<!-- σ --></mi>
            <mo stretchy="false">&#x2192;<!-- → --></mo>
          </mover>
        </mrow>
        <msub>
          <mi>F</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle 
V_I (\mathbf{r})=2\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M_I}\right)\right]
\cdot \vec{\sigma} F_I(|\mathbf{r}|) 
}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=0963381082528a39d44fb0435cda7404&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -2.505ex; height: 6.176ex; width: 45.707ex;" alt="{\displaystyle &#10;V_I (\mathbf{r})=2\lambda \left[ \vec{M}_I-\hat{M}^0_I \left( \hat{M}^0_I \cdot \vec{M_I}\right)\right]&#10;\cdot \vec{\sigma} F_I(|\mathbf{r}|) &#10;}"/></span></dd></dl></dd></dl>
<dl><dd>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \vec{\sigma}=(\sigma_x,\sigma_y,\sigma_z)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mover>
            <mi>&#x03C3;<!-- σ --></mi>
            <mo stretchy="false">&#x2192;<!-- → --></mo>
          </mover>
        </mrow>
        <mo>=</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>&#x03C3;<!-- σ --></mi>
          <mi>x</mi>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>&#x03C3;<!-- σ --></mi>
          <mi>y</mi>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>&#x03C3;<!-- σ --></mi>
          <mi>z</mi>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \vec{\sigma}=(\sigma_x,\sigma_y,\sigma_z)}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=5c2e10c1b208dcf63d05b74bf64a5206&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.005ex; height: 3.009ex; width: 15.511ex;" alt="{\displaystyle \vec{\sigma}=(\sigma_x,\sigma_y,\sigma_z)}"/></span> are the Pauli spin-matrices.</dd></dl>
<ul><li><a class="mw-selflink selflink">I_CONSTRAINED_M</a>=2: Constrain the <i>size and direction</i> of the magnetic moments.</li></ul>
<dl><dd>The total energy is given by</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle E=E_0+ \sum_I\lambda \left( \vec{M}_I-\vec{M}^0_I \right)^2}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>E</mi>
        <mo>=</mo>
        <msub>
          <mi>E</mi>
          <mn>0</mn>
        </msub>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mi>I</mi>
        </munder>
        <mi>&#x03BB;<!-- λ --></mi>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mover>
                    <mi>M</mi>
                    <mo stretchy="false">&#x2192;<!-- → --></mo>
                  </mover>
                </mrow>
                <mi>I</mi>
              </msub>
              <mo>&#x2212;<!-- − --></mo>
              <msubsup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mover>
                    <mi>M</mi>
                    <mo stretchy="false">&#x2192;<!-- → --></mo>
                  </mover>
                </mrow>
                <mi>I</mi>
                <mn>0</mn>
              </msubsup>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle E=E_0+ \sum_I\lambda \left( \vec{M}_I-\vec{M}^0_I \right)^2}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=dc8403d331cbcc8afc9f2482096b23cc&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; height: 6.509ex; width: 29.257ex;" alt="{\displaystyle E=E_0+ \sum_I\lambda \left( \vec{M}_I-\vec{M}^0_I \right)^2}"/></span></dd></dl></dd></dl>
<dl><dd>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \vec{M}^0_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x2192;<!-- → --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
          <mn>0</mn>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \vec{M}^0_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=f54964ac7252cbc5c9e62c951630ea7b&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; height: 3.843ex; width: 3.503ex;" alt="{\displaystyle \vec{M}^0_I}"/></span> is the desired magnetic moment at site <i>I</i> (as specified using <a href="/wiki/index.php/M_CONSTR" title="M CONSTR">M_CONSTR</a>).</dd>
<dd>The additional potential that arises from the penalty contribution to the total energy is given by
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle V_I (\mathbf{r})=2\lambda \left( \vec{M}_I-\vec{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>V</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mn>2</mn>
        <mi>&#x03BB;<!-- λ --></mi>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x2192;<!-- → --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
            </msub>
            <mo>&#x2212;<!-- − --></mo>
            <msubsup>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x2192;<!-- → --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
              <mn>0</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>&#x22C5;<!-- ⋅ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mover>
            <mi>&#x03C3;<!-- σ --></mi>
            <mo stretchy="false">&#x2192;<!-- → --></mo>
          </mover>
        </mrow>
        <msub>
          <mi>F</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle V_I (\mathbf{r})=2\lambda \left( \vec{M}_I-\vec{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=fe96e8d2df887d79e023575b4c9caad6&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; height: 4.843ex; width: 33.722ex;" alt="{\displaystyle V_I (\mathbf{r})=2\lambda \left( \vec{M}_I-\vec{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}"/></span></dd></dl></dd></dl>
<ul><li><a class="mw-selflink selflink">I_CONSTRAINED_M</a>=4: Constrain the <i>direction and sign</i> of the magnetic moments<sup id="cite_ref-ma:prb:15_1-0" class="reference"><a href="#cite_note-ma:prb:15-1">&#91;1&#93;</a></sup>, available since VASP.6.4.0.</li></ul>
<dl><dd>The total energy is given by</dd></dl>
<dl><dd><dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle E=E_0+ \sum_I\lambda \left( |\vec{M}_I| - \hat{M}^0_I \cdot \vec{M}_I\right)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>E</mi>
        <mo>=</mo>
        <msub>
          <mi>E</mi>
          <mn>0</mn>
        </msub>
        <mo>+</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mi>I</mi>
        </munder>
        <mi>&#x03BB;<!-- λ --></mi>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow class="MJX-TeXAtom-ORD">
              <mo stretchy="false">|</mo>
            </mrow>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x2192;<!-- → --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
            </msub>
            <mrow class="MJX-TeXAtom-ORD">
              <mo stretchy="false">|</mo>
            </mrow>
            <mo>&#x2212;<!-- − --></mo>
            <msubsup>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
              <mn>0</mn>
            </msubsup>
            <mo>&#x22C5;<!-- ⋅ --></mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x2192;<!-- → --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
            </msub>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle E=E_0+ \sum_I\lambda \left( |\vec{M}_I| - \hat{M}^0_I \cdot \vec{M}_I\right)}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=dc88e8754601c56926b1cda1e3b4ecb6&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -3.005ex; height: 6.009ex; width: 35.066ex;" alt="{\displaystyle E=E_0+ \sum_I\lambda \left( |\vec{M}_I| - \hat{M}^0_I \cdot \vec{M}_I\right)}"/></span></dd></dl></dd></dl>
<dl><dd>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \hat{M}^0_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
          <mn>0</mn>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \hat{M}^0_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=f814d03af5c01c4c623e4ed8424b1cee&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.838ex; height: 3.843ex; width: 3.503ex;" alt="{\displaystyle \hat{M}^0_I}"/></span> is the desired magnetic moment at site <i>I</i> (as specified using <a href="/wiki/index.php/M_CONSTR" title="M CONSTR">M_CONSTR</a>).</dd>
<dd>The additional potential that arises from the penalty contribution to the total energy is given by
<dl><dd><span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle V_I (\mathbf{r})=\lambda \left( \hat{M}_I-\hat{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>V</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>&#x03BB;<!-- λ --></mi>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
            </msub>
            <mo>&#x2212;<!-- − --></mo>
            <msubsup>
              <mrow class="MJX-TeXAtom-ORD">
                <mover>
                  <mi>M</mi>
                  <mo stretchy="false">&#x005E;<!-- ^ --></mo>
                </mover>
              </mrow>
              <mi>I</mi>
              <mn>0</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>&#x22C5;<!-- ⋅ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mover>
            <mi>&#x03C3;<!-- σ --></mi>
            <mo stretchy="false">&#x2192;<!-- → --></mo>
          </mover>
        </mrow>
        <msub>
          <mi>F</mi>
          <mi>I</mi>
        </msub>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">r</mi>
        </mrow>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle V_I (\mathbf{r})=\lambda \left( \hat{M}_I-\hat{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=83c299bc477671b46298f284e74bd4c4&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -1.838ex; height: 4.843ex; width: 32.559ex;" alt="{\displaystyle V_I (\mathbf{r})=\lambda \left( \hat{M}_I-\hat{M}^0_I \right)\cdot \vec{\sigma} F_I(|\mathbf{r}|)}"/></span></dd></dl></dd>
<dd>where <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \hat{M}_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x005E;<!-- ^ --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \hat{M}_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=76e03049e1e9cf5a51a54bda1bd36728&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; height: 3.176ex; width: 3.503ex;" alt="{\displaystyle \hat{M}_I}"/></span> denotes the unit vector in <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \vec{M}_I}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mover>
              <mi>M</mi>
              <mo stretchy="false">&#x2192;<!-- → --></mo>
            </mover>
          </mrow>
          <mi>I</mi>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \vec{M}_I}</annotation>
  </semantics>
</math></span><img src="/wiki/index.php?title=Special:MathShowImage&amp;hash=15da3de56669a82d324abed01f9f0e0c&amp;mode=mathml" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.671ex; height: 3.176ex; width: 3.503ex;" alt="{\displaystyle \vec{M}_I}"/></span> direction.</dd></dl>
<p>The weight &#955;, with which the penalty terms enter into the total energy expression and the Hamiltonian in the above is specified through the <a href="/wiki/index.php/LAMBDA" title="LAMBDA">LAMBDA</a> tag.
</p><p>As is probably clear from the above, applying constraints by means of a penalty functional contributes to the total energy. This contribution, however, decreases with increasing <a href="/wiki/index.php/LAMBDA" title="LAMBDA">LAMBDA</a> and can in principle be made vanishingly small <sup id="cite_ref-ma:prb:15_1-1" class="reference"><a href="#cite_note-ma:prb:15-1">&#91;1&#93;</a></sup>. Increasing <a href="/wiki/index.php/LAMBDA" title="LAMBDA">LAMBDA</a> stepwise, from one run to another (slowly so the solution remains stable) one thus converges towards the DFT total energy for a given magnetic configuration.
</p>
<hr />
<p>When one uses the constrained moment approach, additional information pertaining to the effect of the constraints is written into the <a href="/wiki/index.php/OSZICAR" title="OSZICAR">OSZICAR</a> file:
</p>
<pre> E_p =  0.36856E-07  lambda =  0.500E+02
&lt;lVp&gt;=  0.30680E-02
 DBL = -0.30680E-02
 ion        MW_int                 M_int
  1 -0.565  0.000  0.000   -0.770  0.000  0.000
  2  0.565  0.000  0.000    0.770  0.000  0.000
  3 -0.565  0.000  0.000   -0.770  0.000  0.000
  4  0.565  0.000  0.000    0.770  0.000  0.000
DAV:   8    -0.133293620177E+03    0.15284E-05   -0.29410E-08  4188   0.144E-03    0.119E-04
</pre>
<p><tt>E_p</tt> is the contribution to the total energy arising from the penalty functional. Under <tt>M_int</tt> VASP lists the integrated magnetic moment at each atomic site. The column labeled <tt>MW_int</tt> shows the result of the integration of magnetization density which has been smoothed towards the boundary of the sphere. It is actually the <a href="#MWint">smoothed integrated moment</a> which enters in the penalty terms (the smoothing ensures that the total local potential remains continuous at the sphere boundary). One should look at the latter numbers to check whether enough of the magnetization density around each atomic site is contained within the integration sphere and increase <a href="/wiki/index.php/RWIGS" title="RWIGS">RWIGS</a> accordingly. What exactly constitutes "enough" in this context is hard to say. It is best to set <a href="/wiki/index.php/RWIGS" title="RWIGS">RWIGS</a> in such a manner that the integration spheres do not overlap and are otherwise as large as possible.
</p>
<pre>DAV:   9    -0.133293621087E+03   -0.91037E-06   -0.18419E-08  4188   0.104E-03
   1 F= -.13329362E+03 E0= -.13329362E+03  d E =0.000000E+00  mag=     0.0000     0.0000     0.0000

 E_p =  0.36600E-07  lambda =  0.500E+02
 ion             lambda*MW_perp
  1  -0.67580E-03  -0.12424E-22  -0.88276E-23
  2   0.67580E-03   0.14700E-22  -0.24744E-22
  3  -0.67790E-03  -0.82481E-23  -0.19834E-22
  4   0.67790E-03   0.15710E-23   0.34505E-22
</pre>
<p>Under <tt>lambda*MW_perp</tt> the constraining "magnetic field" at each atomic site is listed. It shows which magnetic field is added to the DFT Hamiltonian to stabilize the magnetic configuration.
</p>
<h2><span class="mw-headline" id="Related_tags_and_articles">Related tags and articles</span></h2>
<p><a href="/wiki/index.php/M_CONSTR" title="M CONSTR">M_CONSTR</a>,
<a href="/wiki/index.php/LAMBDA" title="LAMBDA">LAMBDA</a>,
<a href="/wiki/index.php/RWIGS" title="RWIGS">RWIGS</a>,
<a href="/wiki/index.php/LNONCOLLINEAR" title="LNONCOLLINEAR">LNONCOLLINEAR</a>
</p><p><a href="/wiki/index.php/Special:Search/%22I_CONSTRAINED_M%22_incategory:%22Examples%22" title="Special:Search/&quot;I CONSTRAINED M&quot; incategory:&quot;Examples&quot;">Examples that use this tag</a>
</p>
<hr />
<h2><span class="mw-headline" id="References">References</span></h2>
<div class="mw-references-wrap"><ol class="references">
<li id="cite_note-ma:prb:15-1">↑ <sup><a href="#cite_ref-ma:prb:15_1-0">a</a></sup> <sup><a href="#cite_ref-ma:prb:15_1-1">b</a></sup> <span class="reference-text"><a rel="nofollow" class="external text" href="http://doi.org/10.1103/PhysRevB.91.054420">P.-W. Ma and S. L. Dudarev, <i>Constrained density functional for noncollinear magnetism</i>, Phys. Rev. B <b>91</b>, 054420 (2015).</a></span>
</li>
</ol></div>
<!-- 
NewPP limit report
Cached time: 20250305164339
Cache expiry: 86400
Reduced expiry: false
Complications: [no‐toc‐conversion]
CPU time usage: 0.228 seconds
Real time usage: 0.357 seconds
Preprocessor visited node count: 12091/1000000
Post‐expand include size: 775/2097152 bytes
Template argument size: 28609/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 714/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  204.013      1 -total
 96.76%  197.395      2 Template:Cite
 57.09%  116.472    844 Template:Reference
  0.67%    1.373     19 Template:TAG
  0.59%    1.194      1 Template:TAGDEF
  0.35%    0.717      1 Template:FILE
  0.35%    0.710      1 Template:Sc
-->

<!-- Saved in parser cache with key mediawiki-vw:pcache:idhash:116-0!canonical and timestamp 20250305164338 and revision id 20734. Rendering was triggered because: page-view
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://www.vasp.at/wiki/index.php?title=I_CONSTRAINED_M&amp;oldid=20734">https://www.vasp.at/wiki/index.php?title=I_CONSTRAINED_M&amp;oldid=20734</a>"</div></div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/index.php/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/wiki/index.php/Category:INCAR_tag" title="Category:INCAR tag">INCAR tag</a></li><li><a href="/wiki/index.php/Category:Magnetism" title="Category:Magnetism">Magnetism</a></li></ul></div></div>
					
				</div>
				
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 2 October 2023, at 15:46.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="/wiki/index.php/VASP_Wiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/index.php/VASP_Wiki:About">About VASP Wiki</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/index.php/VASP_Wiki:General_disclaimer">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.txt"><img src="/wiki/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" loading="lazy"/></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":541,"wgPageParseReport":{"limitreport":{"cputime":"0.228","walltime":"0.357","ppvisitednodes":{"value":12091,"limit":1000000},"postexpandincludesize":{"value":775,"limit":2097152},"templateargumentsize":{"value":28609,"limit":2097152},"expansiondepth":{"value":6,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":714,"limit":5000000},"timingprofile":["100.00%  204.013      1 -total"," 96.76%  197.395      2 Template:Cite"," 57.09%  116.472    844 Template:Reference","  0.67%    1.373     19 Template:TAG","  0.59%    1.194      1 Template:TAGDEF","  0.35%    0.717      1 Template:FILE","  0.35%    0.710      1 Template:Sc"]},"cachereport":{"timestamp":"20250305164339","ttl":86400,"transientcontent":false}}});});</script>
</body>
<!-- Cached 20250305164339 -->
</html>